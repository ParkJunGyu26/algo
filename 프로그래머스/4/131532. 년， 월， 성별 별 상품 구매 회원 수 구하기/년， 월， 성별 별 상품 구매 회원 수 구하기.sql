-- 코드를 입력하세요

SELECT
    YEAR(os.SALES_DATE) AS YEAR,
    MONTH(os.SALES_DATE) AS MONTH,
    ui.GENDER AS GENDER,
    COUNT(DISTINCT os.USER_ID) AS USERS
FROM
    USER_INFO AS ui
JOIN
    ONLINE_SALE AS os
ON
    ui.USER_ID = os.USER_ID
WHERE
    ui.GENDER IS NOT NULL
GROUP BY
    YEAR(os.SALES_DATE), MONTH(os.SALES_DATE), ui.GENDER
HAVING
    COUNT(os.USER_ID) > 0
ORDER BY
    YEAR ASC,
    MONTH ASC,
    GENDER ASC

-- 2022 / 1 : 61
-- 2022 / 2 : 53
-- 2022 / 3 : 8

# USER_ID	SALES_DATE
# 2	    2022-01-01 00:00:00
# 7	    2022-01-01 00:00:00
# 45	2022-01-01 00:00:00
# 12	2022-01-02 00:00:00
# 109	2022-01-02 00:00:00
# 152	2022-01-02 00:00:00
# 154	2022-01-02 00:00:00
# 57	2022-01-03 00:00:00
# 120	2022-01-03 00:00:00
# 2	    2022-01-05 00:00:00
# 15	2022-01-05 00:00:00
# 109	2022-01-05 00:00:00
# 117	2022-01-05 00:00:00
# 131	2022-01-05 00:00:00
# 154	2022-01-05 00:00:00
# 90	2022-01-07 00:00:00
# 162	2022-01-07 00:00:00
# 58	2022-01-08 00:00:00
# 92	2022-01-08 00:00:00
# 123	2022-01-08 00:00:00
# 126	2022-01-08 00:00:00
# 23	2022-01-09 00:00:00
# 65	2022-01-09 00:00:00
# 149	2022-01-09 00:00:00
# 42	2022-01-12 00:00:00
# 81	2022-01-12 00:00:00
# 117	2022-01-12 00:00:00
# 108	2022-01-14 00:00:00
# 4	2022-01-15 00:00:00
# 56	2022-01-15 00:00:00
# 84	2022-01-15 00:00:00
# 143	2022-01-15 00:00:00
# 57	2022-01-17 00:00:00
# 68	2022-01-17 00:00:00
# 113	2022-01-17 00:00:00
# 120	2022-01-17 00:00:00
# 127	2022-01-17 00:00:00
# 99	2022-01-18 00:00:00
# 134	2022-01-18 00:00:00
# 7	    2022-01-21 00:00:00
# 101	2022-01-21 00:00:00
# 23	2022-01-22 00:00:00
# 29	2022-01-22 00:00:00
# 73	2022-01-22 00:00:00
# 160	2022-01-22 00:00:00
# 15	2022-01-24 00:00:00
# 27	2022-01-24 00:00:00
# 34	2022-01-24 00:00:00
# 134	2022-01-24 00:00:00
# 55	2022-01-25 00:00:00
# 151	2022-01-25 00:00:00
# 78	2022-01-26 00:00:00
# 93	2022-01-26 00:00:00
# 58	2022-01-27 00:00:00
# 114	2022-01-27 00:00:00
# 118	2022-01-28 00:00:00
# 87	2022-01-29 00:00:00
# 22	2022-01-31 00:00:00
# 35	2022-01-31 00:00:00
# 102	2022-01-31 00:00:00
# 117	2022-01-31 00:00:00

# 14	2022-02-02 00:00:00
# 50	2022-02-02 00:00:00
# 66	2022-02-02 00:00:00
# 170	2022-02-02 00:00:00
# 133	2022-02-03 00:00:00
# 66	2022-02-04 00:00:00
# 121	2022-02-04 00:00:00
# 19	2022-02-06 00:00:00
# 62	2022-02-06 00:00:00
# 72	2022-02-06 00:00:00
# 74	2022-02-06 00:00:00
# 46	2022-02-07 00:00:00
# 73	2022-02-07 00:00:00
# 111	2022-02-07 00:00:00
# 119	2022-02-07 00:00:00
# 29	2022-02-09 00:00:00
# 59	2022-02-09 00:00:00
# 145	2022-02-09 00:00:00
# 180	2022-02-09 00:00:00
# 41	2022-02-11 00:00:00
# 54	2022-02-11 00:00:00
# 78	2022-02-11 00:00:00
# 139	2022-02-11 00:00:00
# 157	2022-02-11 00:00:00
# 43	2022-02-13 00:00:00
# 53	2022-02-13 00:00:00
# 110	2022-02-13 00:00:00
# 138	2022-02-13 00:00:00
# 37	2022-02-15 00:00:00
# 73	2022-02-15 00:00:00
# 91	2022-02-15 00:00:00
# 183	2022-02-15 00:00:00
# 42	2022-02-16 00:00:00
# 60	2022-02-16 00:00:00
# 78	2022-02-16 00:00:00
# 88	2022-02-16 00:00:00
# 177	2022-02-16 00:00:00
# 61	2022-02-17 00:00:00
# 123	2022-02-17 00:00:00
# 52	2022-02-20 00:00:00
# 114	2022-02-20 00:00:00
# 24	2022-02-22 00:00:00
# 5	    2022-02-23 00:00:00
# 42	2022-02-23 00:00:00
# 134	2022-02-23 00:00:00
# 163	2022-02-23 00:00:00
# 119	2022-02-25 00:00:00
# 184	2022-02-25 00:00:00
# 190	2022-02-25 00:00:00
# 2	    2022-02-26 00:00:00
# 189	2022-02-26 00:00:00
# 13	2022-02-28 00:00:00
# 20	2022-02-28 00:00:00

# 70	2022-03-01 00:00:00
# 98	2022-03-01 00:00:00
# 68	2022-03-03 00:00:00
# 170	2022-03-03 00:00:00
# 68	2022-03-06 00:00:00
# 126	2022-03-06 00:00:00
# 140	2022-03-06 00:00:00
# 103	2022-03-07 00:00:00